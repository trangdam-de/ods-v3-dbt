DELETE FROM {{ params.des_schema }}.{{ params.des_table }}
WHERE TRANS_DATE>= TO_TIMESTAMP('{{ ti.xcom_pull(task_ids="one_to_one_tasks.casreport_rpt_full_item.source_to_staging_casreport_rpt_full_item", key="start_time") }}', 'YYYY-MM-DD HH24:MI:SS')
  AND TRANS_DATE < TO_TIMESTAMP('{{ ti.xcom_pull(task_ids="one_to_one_tasks.casreport_rpt_full_item.source_to_staging_casreport_rpt_full_item", key="end_time") }}', 'YYYY-MM-DD HH24:MI:SS');
  


    INSERT INTO {{ params.des_schema }}.{{ params.des_table }} (
        hdr_id,
        dtl_id,
        add_id,
        bill_id,
        cont_id,
        case_id,
        nguon_ps,
        source_system,
        group_type,
        org_code,
        bdh_code,
        bdt_code,
        username,
        trans_type,
        trans_prop,
        trans_date,
        tt_number,
        shipment_code,
        quantity,
        item_value,
        service_code,
        service_group_id,
        service_gtgt,
        service_type,
        businesss_code,
        tax_code,
        pocode_rec,
        pocode_bdh,
        pocode_bdt,
        national_code,
        hub_from,
        hub_to,
        region_code,
        customer_code_debit,
        customer_code_crm_debit,
        customer_parent_code_debit,
        customer_name_debit,
        customer_add_debit,
        customer_email_debit,
        customer_tell_debit,
        customer_identify_debit,
        customer_contract_number_debit,
        isdomestic,
        ispackagenormal,
        iscod,
        is_c_ppa,
        stamtype,
        zone,
        is_intenal_district,
        weight,
        priceweight,
        weightconver,
        weight_level_detail,
        weight_level_group,
        basic_fee_public,
        add_fee_public,
        cod_fee_public,
        total_fee_public,
        vat_basic_fee_public,
        vat_add_fee_public,
        vat_cod_fee_public,
        total_vat_public,
        taxrate_public,
        basic_fee_public_vat,
        add_fee_public_vat,
        cod_fee_public_vat,
        total_fee_public_vat,
        basic_fee_special,
        add_fee_special,
        cod_fee_special,
        total_fee_special,
        vat_basic_fee_special,
        vat_add_fee_special,
        vat_cod_fee_special,
        total_vat_special,
        taxrate_special,
        basic_fee_special_vat,
        add_fee_special_vat,
        cod_fee_special_vat,
        total_fee_special_vat,
        fee_c_ppa,
        cod_amount,
        ship_amount,
        paynow,
        payment,
        dtl_id_old,
        bdt_thu_cuoc,
        kt_type,
        case_type_id,
        fee_bonus,
        fee_bonus_value,
        procedure_category_id,
        procedure_id,
        procedure_type,
        is_return_transfer,
        customer_code,
        customer_name,
        customer_add,
        idenfify_num,
        customer_acct,
        customer_phone,
        customer_email,
        customer_province_code,
        customer_district_code,
        customer_commune_code,
        customer_code_crm,
        rec_code,
        rec_name,
        rec_add,
        rec_identify,
        rec_acct,
        rec_phone,
        rec_email,
        rec_province_code,
        rec_district_code,
        rec_commune_code,
        rec_code_crm,
        rec_contract_num,
        customer_contract_num,
        contract_num_cppa,
        sender_name,
        sender_add,
        sender_province_code,
        sender_district_code,
        sender_commune_code,
        sender_postal_cdoe,
        sender_phone,
        sender_email,
        is_pkg_incient,
        item_num,
        is_package_normal,
        weightconvert,
        identify_num,
        sender_postal_code,
        business_code,
        tax_declaration_code,
        account,
        bill_dtl_id,
        bd2_num,
        awb_number,
        charge_hcc_amount,
        cod_payer,
        fee_hcc_charge_type,
        fee_hcc_payer,
        scope,
        petro_surcharge_special,
        remote_area_surcharge_special,
        epidemic_season_surcharge_special,
        isvungxa,
        ishaidao,
        addon_json,
        bill_json,
        length_size,
        width_size,
        height_size,
        content_note,
        bulky_service,
        fragile_service,
        delivery_instruction,
        dispatch_number,
        stamp_money,
        other_amount,
        po_json,
        create_date,
        vat_pp_xangdau_special,
        vat_pp_vungxa_special,
        vat_pp_muadich_special,
        order_code,
        pph_fee_public,
        vat_pph_fee_public,
        pph_fee_special,
        vat_pph_fee_special,
        main_fee_public,
        vat_main_fee_public,
        main_fee_special,
        vat_main_fee_special
    )
    SELECT 
        src.hdr_id,
        src.dtl_id,
        src.add_id,
        src.bill_id,
        src.cont_id,
        src.case_id,
        src.nguon_ps,
        src.source_system,
        src.group_type,
        src.org_code,
        src.bdh_code,
        src.bdt_code,
        src.username,
        src.trans_type,
        src.trans_prop,
        src.trans_date,
        src.tt_number,
        src.shipment_code,
        src.quantity,
        src.item_value,
        src.service_code,
        src.service_group_id,
        src.service_gtgt,
        src.service_type,
        src.businesss_code,
        src.tax_code,
        src.pocode_rec,
        src.pocode_bdh,
        src.pocode_bdt,
        src.national_code,
        src.hub_from,
        src.hub_to,
        src.region_code,
        src.customer_code_debit,
        src.customer_code_crm_debit,
        src.customer_parent_code_debit,
        src.customer_name_debit,
        src.customer_add_debit,
        src.customer_email_debit,
        src.customer_tell_debit,
        src.customer_identify_debit,
        src.customer_contract_number_debit,
        src.isdomestic,
        src.ispackagenormal,
        src.iscod,
        src.is_c_ppa,
        src.stamtype,
        src.zone,
        src.is_intenal_district,
        src.weight,
        src.priceweight,
        src.weightconver,
        src.weight_level_detail,
        src.weight_level_group,
        src.basic_fee_public,
        src.add_fee_public,
        src.cod_fee_public,
        src.total_fee_public,
        src.vat_basic_fee_public,
        src.vat_add_fee_public,
        src.vat_cod_fee_public,
        src.total_vat_public,
        src.taxrate_public,
        src.basic_fee_public_vat,
        src.add_fee_public_vat,
        src.cod_fee_public_vat,
        src.total_fee_public_vat,
        src.basic_fee_special,
        src.add_fee_special,
        src.cod_fee_special,
        src.total_fee_special,
        src.vat_basic_fee_special,
        src.vat_add_fee_special,
        src.vat_cod_fee_special,
        src.total_vat_special,
        src.taxrate_special,
        src.basic_fee_special_vat,
        src.add_fee_special_vat,
        src.cod_fee_special_vat,
        src.total_fee_special_vat,
        src.fee_c_ppa,
        src.cod_amount,
        src.ship_amount,
        src.paynow,
        src.payment,
        src.dtl_id_old,
        src.bdt_thu_cuoc,
        src.kt_type,
        src.case_type_id,
        src.fee_bonus,
        src.fee_bonus_value,
        src.procedure_category_id,
        src.procedure_id,
        src.procedure_type,
        src.is_return_transfer,
        src.customer_code,
        src.customer_name,
        src.customer_add,
        src.idenfify_num,
        src.customer_acct,
        src.customer_phone,
        src.customer_email,
        src.customer_province_code,
        src.customer_district_code,
        src.customer_commune_code,
        src.customer_code_crm,
        src.rec_code,
        src.rec_name,
        src.rec_add,
        src.rec_identify,
        src.rec_acct,
        src.rec_phone,
        src.rec_email,
        src.rec_province_code,
        src.rec_district_code,
        src.rec_commune_code,
        src.rec_code_crm,
        src.rec_contract_num,
        src.customer_contract_num,
        src.contract_num_cppa,
        src.sender_name,
        src.sender_add,
        src.sender_province_code,
        src.sender_district_code,
        src.sender_commune_code,
        src.sender_postal_cdoe,
        src.sender_phone,
        src.sender_email,
        src.is_pkg_incient,
        src.item_num,
        src.is_package_normal,
        src.weightconvert,
        src.identify_num,
        src.sender_postal_code,
        src.business_code,
        src.tax_declaration_code,
        src.account,
        src.bill_dtl_id,
        src.bd2_num,
        src.awb_number,
        src.charge_hcc_amount,
        src.cod_payer,
        src.fee_hcc_charge_type,
        src.fee_hcc_payer,
        src.scope,
        src.petro_surcharge_special,
        src.remote_area_surcharge_special,
        src.epidemic_season_surcharge_special,
        src.isvungxa,
        src.ishaidao,
        src.addon_json,
        src.bill_json,
        src.length_size,
        src.width_size,
        src.height_size,
        src.content_note,
        src.bulky_service,
        src.fragile_service,
        src.delivery_instruction,
        src.dispatch_number,
        src.stamp_money,
        src.other_amount,
        src.po_json,
        src.create_date,
        src.vat_pp_xangdau_special,
        src.vat_pp_vungxa_special,
        src.vat_pp_muadich_special,
        src.order_code,
        src.pph_fee_public,
        src.vat_pph_fee_public,
        src.pph_fee_special,
        src.vat_pph_fee_special,
        src.main_fee_public,
        src.vat_main_fee_public,
        src.main_fee_special,
        src.vat_main_fee_special
    FROM staging.{{ params.des_schema }}_{{ params.des_table }} src ;
